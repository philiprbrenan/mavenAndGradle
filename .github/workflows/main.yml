# Test NasmX86

name: Test

on:
  push

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
      with:
        ref: 'main'

    - name: Download other repos
      run: |
        curl -sL https://github.com/philiprbrenan/DataTableText/archive/refs/heads/main.zip > DataTableText.zip
        unzip DataTableText
        cp -R DataTableText-main/* .

    - name: Install Data::Dump
      run: |
        sudo cpan install -T Data::Dump

    - name: Tree
      run: |
        tree

    - name: Test
      run: |
        sudo apt install maven gradle

    - name: Install Mvn
      run: |
        mvn -B archetype:generate -DgroupId=com.ashley.test  -DartifactId=test -DarchetypeArtifactId=maven-archetype-quickstart -DarchetypeVersion=1.4

    - name: Mvn downloads so we do not time network activity
      run: |
        cd test
        mvn compile
        mvn test
        rm -f ./target/classes/com/ashley/test/App.class
        rm -f ./build/classes/java/main/com/ashley/test/App.class

    - name: Mvn
      run: |
        cd test
        mvn compile
        mvn test

    - name: Gradle Init
      run: |
        cd test
        gradle init

    - name: Upgrade
      run: |
        perl -Ilib upgradeVersion.pl

    - name: Gradle Build
      run: |
        cd test
        gradle build
